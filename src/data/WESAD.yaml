# data paths  
pretrain_index_file: /home/sl29/data/WESAD/time_data_partition_four_class/train_index.txt
stress_classification:
        num_classes: 4
        class_names: ["baseline", "stress", "amusement", "meditation"]
        train_index_file: /home/sl29/data/WESAD/time_data_partition_four_class/train_index.txt
        val_index_file: /home/sl29/data/WESAD/time_data_partition_four_class/test_index.txt 
        test_index_file: /home/sl29/data/WESAD/time_data_partition_four_class/test_index.txt

# Segments
num_segments: 15

# Locations 
num_locaiton: 1
location_names: ["chest"]

# Modality names
num_sensors: 3
modality_names: ["EMG", "EDA", "Resp"]

# Location modalities
loc_mod_in_freq_channels:
        chest:
                EMG: 2
                EDA: 2
                Resp: 2
loc_mod_in_time_channels:
        chest:
                EMG: 1
                EDA: 1
                Resp: 1
loc_mod_spectrum_len:
        chest:
                EMG: 140
                EDA: 140
                Resp: 140

# DeepSense config
DeepSense:
        dropout_ratio: 0.4
        # single interval + location + modality
        loc_mod_in_conv_stride:
                EMG: [1, 1]
                EDA: [1, 1]
                Resp: [1, 1]
        loc_mod_conv_lens: 
                EMG: [[1, 10], [1, 10], [1, 10]]
                EDA: [[1, 10], [1, 10], [1, 10]]
                Resp: [[1, 10], [1, 10], [1, 10]]
        loc_mod_out_channels: 16
        loc_mod_conv_inter_layers: 2
        # single interval + location
        loc_conv_lens: [[1, 4], [1, 4], [1, 4]]
        loc_out_channels: 32
        loc_conv_inter_layers: 1
        # recurrent layer
        recurrent_dim: 32
        recurrent_layers: 2
        # FC layer
        fc_dim: 32
        # Training config
        train_epochs: 200
        scheduler_step: 50
        scheduler_gamma: 0.2
        start_lr: 0.00001

TransformerV4:
        dropout_ratio: 0.5
        drop_path_rate: 0.5
        attn_drop_rate: 0.5
        # loc mod freq feature
        loc_mod_in_stride:
                EMG: 1
                EDA: 1
                Resp: 1
        loc_mod_freq_out_channels: 64
        loc_mod_freq_head_num: 4
        loc_mod_freq_block_num: 2
        # single modality
        time_freq_out_channels: 8
        time_freq_head_num: 4
        time_freq_block_num: 
                ACC: [2]
                ECG: [2]
                EMG: [2]
                EDA: [2]
                Resp: [2]
        # modality fusion
        mod_out_channels: 8
        mod_head_num: 4
        mod_block_num: 1
        # location fusion
        loc_out_channels: 8 # loc_out_channels == mod_out_channels
        loc_head_num: 4
        loc_block_num: 1
        # SwinTransformer configs
        window_size: 
                ACC: [2, 5]
                ECG: [2, 5]
                EMG: [2, 5]
                EDA: [2, 5]
                Resp: [2, 5]
        mlp_ratio: 1.
        qkv_bias: True
        APE: False
        patch_norm: True
        patch_size:
                freq:
                        ACC: [1, 7]
                        ECG: [1, 7]
                        EMG: [1, 7]
                        EDA: [1, 7]
                        Resp: [1, 7]
        # FC layer
        fc_dim: 8
        pretrained_head: "linear"
        # Optimizer config
        optimizer:
                name: "AdamW"
                start_lr: 0.0005
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 1
        # LR scheduler
        lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 500
                start_epoch: 0
                decay_epochs: 100
                decay_rate: 0.2
        # Data Augmenters:
        fixed_augmenters:
                time_augmenters: ["no"]
                freq_augmenters: ["phase_shift"]

# ---------------------------------------- Contrastive Learning Frameworks ------------------------------------
SimCLR:
        emb_dim: 128
        temperature: 0.07
        # Pre training  
        pretrain_optimizer:
                name: "AdamW"
                start_lr: 0.0001
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 0.05
        pretrain_lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 1000
                start_epoch: 0
                decay_epochs: 200
                decay_rate: 0.2
        # Fine tuning 
        finetune_optimizer:
                name: "Adam"
                start_lr: 0.001
                warmup_lr: 0.000001
                min_lr: 0.000001
                clip_grad: 5.0
                weight_decay: 0.00001
        finetune_lr_scheduler:
                name: "step"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 200
                start_epoch: 0
                decay_epochs: 50
                decay_rate: 0.2
        # Augmenters
        random_augmenters:
                time_augmenters: ["permutation", "negation", "time_warp", "horizontal_flip", "mag_warp", "scaling"]
                freq_augmenters: ["phase_shift"]

MoCo:
        emb_dim: 128
        temperature: 0.07
        momentum: 0.99
        # Pre training  
        pretrain_optimizer:
                name: "AdamW"
                start_lr: 0.0001
                warmup_lr: 0.000001
                min_lr: 0.000001
                clip_grad: 5.0
                weight_decay: 0.05
        pretrain_lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 1000
                start_epoch: 0
                decay_epochs: 200
                decay_rate: 0.2
        # Fine tuning 
        finetune_optimizer:
                name: "Adam"
                start_lr: 0.01
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 0.05
        finetune_lr_scheduler:
                name: "step"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 200
                start_epoch: 0
                decay_epochs: 50
                decay_rate: 0.2
        # Augmenters
        random_augmenters:
                time_augmenters: ["permutation", "negation", "time_warp", "horizontal_flip", "mag_warp", "scaling"]
                freq_augmenters: ["phase_shift"]

CMC:
        emb_dim: 64
        softmax: True
        temperature: 0.5
        # Pre training  
        pretrain_optimizer:
                name: "AdamW"
                start_lr: 0.0001
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 0.5
        pretrain_lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 1000
                start_epoch: 0
                decay_epochs: 200
                decay_rate: 0.2
        # Fine tuning 
        finetune_optimizer:
                name: "Adam"
                start_lr: 0.001
                warmup_lr: 0.000001
                min_lr: 0.000001
                clip_grad: 5.0
                weight_decay: 0.05
                decay_rate: 0.2
        finetune_lr_scheduler:
                name: "step"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 200
                start_epoch: 0
                decay_epochs: 50
                decay_rate: 0.2
        # Augmenters
        random_augmenters:
                time_augmenters: ["permutation", "negation", "time_warp", "horizontal_flip", "mag_warp", "scaling"]
                freq_augmenters: ["phase_shift"]

CMCV2:
        emb_dim: 64
        temperature: 0.2
        inter_rank_margin: 1
        intra_rank_margin: 0.05
        shared_contrastive_loss_weight: 1
        private_contrastive_loss_weight: 1
        orthogonal_loss_weight: 1
        rank_loss_weight: 1
        # Pre training  
        pretrain_optimizer:
                name: "AdamW"
                start_lr: 0.0001
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 0.5
        pretrain_lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 1000
                start_epoch: 0
                decay_epochs: 200
                decay_rate: 0.2
        # Fine tuning 
        finetune_optimizer:
                name: "Adam"
                start_lr: 0.005
                warmup_lr: 0.000001
                min_lr: 0.000001
                clip_grad: 5.0
                weight_decay: 0.05
                decay_rate: 0.2
        finetune_lr_scheduler:
                name: "step"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 200
                start_epoch: 0
                decay_epochs: 50
                decay_rate: 0.2
        # Augmenters
        random_augmenters:
                time_augmenters: ["permutation", "negation", "time_warp", "horizontal_flip", "mag_warp", "scaling"]
                freq_augmenters: ["phase_shift"]

Cosmo:
        temperature: 0.2
        num_positive: 10
        emb_dim: 128
        contrast_mode: all
        # Pre training  
        pretrain_optimizer:
                name: "AdamW"
                start_lr: 0.00001
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 0.05
        pretrain_lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 1000
                start_epoch: 0
                decay_epochs: 200
                decay_rate: 0.2
        # Fine tuning 
        finetune_optimizer:
                name: "Adam"
                start_lr: 0.001
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 0.00001
        finetune_lr_scheduler:
                name: "step"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 200
                start_epoch: 0
                decay_epochs: 50
                decay_rate: 0.2
        # data augmenters
        random_augmenters:
                time_augmenters: ["no"]
                freq_augmenters: []

Cocoa:
        temperature: 0.5
        scale_loss: 0.03125
        lambd: 3.9e-3
        # Pre training  
        pretrain_optimizer:
                name: "AdamW"
                start_lr: 0.0001
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 0.05
        pretrain_lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 1000
                start_epoch: 0
                decay_epochs: 200
                decay_rate: 0.2
        # Fine tuning 
        finetune_optimizer:
                name: "Adam"
                start_lr: 0.001
                warmup_lr: 0.000001
                min_lr: 0.0000001
                clip_grad: 5.0
                weight_decay: 0.005
        finetune_lr_scheduler:
                name: "step"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 200
                start_epoch: 0
                decay_epochs: 50
                decay_rate: 0.2
        # data augmenters
        random_augmenters:
                time_augmenters: ["permutation", "negation", "time_warp", "horizontal_flip", "mag_warp", "scaling"]
                freq_augmenters: ["phase_shift"]

MTSS:
        # Pre training  
        pretrain_optimizer:
                name: "AdamW"
                start_lr: 0.0001
                warmup_lr: 0.000001
                min_lr: 0.000001
                clip_grad: 5.0
                weight_decay: 0.05
        pretrain_lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 1000
                start_epoch: 0
                decay_epochs: 200
                decay_rate: 0.2
        # Fine tuning 
        finetune_optimizer:
                name: "AdamW"
                start_lr: 0.001
                warmup_lr: 0.000001
                min_lr: 0.000001
                clip_grad: 5.0
                weight_decay: 0.005
        finetune_lr_scheduler:
                name: "cosine"
                warmup_prefix: True
                warmup_epochs: 0
                train_epochs: 200
                start_epoch: 0
                decay_epochs: 50
                decay_rate: 0.2
        # data augmenters
        random_augmenters:
                time_augmenters: ["permutation", "negation", "time_warp", "horizontal_flip", "mag_warp", "scaling"]
                freq_augmenters: ["phase_shift"]

# --------------------------------- Noise detectors ---------------------------------
# Density Detector 
DensityDetector:
        sensors: 3
        interval_num: 15
        # Pretrain config
        pretrain_epochs: 1
        # threshold
        threshold: -50

# Reconstruction Detection
ReconstructionDetector:
        sensors: 3
        interval_num: 15
        # threshold
        threshold: 0.005
        # Architecture dims
        conv_inter_channels: 64
        conv_out_channels: 48
        conv_kernel_size:
                feature: [[3, 3], [3, 3], [3, 3]]
                time:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
                frequency:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]          
        conv_stride:
                feature: [[1, 1], [1, 1], [1, 1]]
                time:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
                frequency:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
        fc_dim: 2
        conv_inter_layer_num: 2
        # Handler loss weight
        classifier_loss_weight: 0
        detector_loss_weight: 1
        # Pretrain config 
        pretrain_epochs: 100
        pretrain_scheduler_step: 20
        pretrain_scheduler_gamma: 0.2
        pretrain_start_lr: 
                feature_DeepSense: 0.0005
                feature_ResNet: 0.005
                feature_Transformer: 0.001
                time: 0.05
                frequency: 0.5

# VAE Plus Detector 
VAEPlusDetector:
        sensors: 3
        interval_num: 15
        # threshold
        threshold: 5
        # Architecture dims
        conv_inter_channels: 32
        conv_out_channels: 16
        conv_kernel_size:
                feature: [[3, 3], [3, 3], [3, 3]]
                time:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
                frequency:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
        conv_stride:
                feature: [[1, 1], [1, 1], [1, 1]]
                time:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
                frequency:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
        fc_dim: 2
        conv_inter_layer_num: 0
        # VAE loss
        classifier_loss_weight: 0
        detector_loss_weight: 1
        kl_divergence_weight: 
                feature_DeepSense: 100
                feature_ResNet: 1000
                feature_Transformer: 100
                time: 100
                frequency: 100 
        corr_loss_weight: 0
        # Pretrain config 
        pretrain_epochs: 100
        pretrain_scheduler_step: 20
        pretrain_scheduler_gamma: 0.2
        pretrain_start_lr: 
                feature_DeepSense: 0.002
                feature_ResNet: 0.005
                feature_Transformer: 0.005
                time: 0.0005
                frequency: 0.005


# --------------------------------- Noise handlers ---------------------------------
# ResilientHandler
ResilientHandler:
        # architecture
        inter_dim: 16
        # Handler loss weight
        handler_loss_weight: 0.1
        classifier_loss_weight: 1
        # Pretrain config 
        pretrain_epochs: 60
        pretrain_scheduler_step: 20
        pretrain_scheduler_gamma: 0.1
        pretrain_start_lr: 
                feature_DeepSense: 0.1 
                feature_ResNet: 0.1 
                feature_Transformer: 0.1 
                time: 0.005
                frequency: 0.05
        # Finetuning config 
        finetune_epochs: 50
        finetune_scheduler_step: 10
        finetune_scheduler_gamma: 0.2
        finetune_start_lr: 0.000001

# Cascaded Residual AutoEncoder
CascadedResidualAutoencoder:
        sensors: 3
        # Architecture dims
        ra_block_num: 3
        interval_num: 15
        conv_inter_channels: 64
        conv_out_channels: 64
        conv_kernel_size:
                feature: [[3, 3], [3, 3], [3, 3]]
                time:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
                frequency:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
        conv_stride:
                feature: [[1, 1], [1, 1], [1, 1]]
                time:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
                frequency:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
        fc_dim: 16
        conv_inter_layer_num: 1
        # Handler loss weight
        classifier_loss_weight: 1
        handler_loss_weight: 1
        # Pretrain config 
        pretrain_epochs: 50
        pretrain_scheduler_step: 10
        pretrain_scheduler_gamma: 0.2
        pretrain_start_lr: 0.001
        # Finetuning config 
        finetune_epochs: 50
        finetune_scheduler_step: 10
        finetune_scheduler_gamma: 0.2
        finetune_start_lr: 0.00001

# CyclicAutoencoder
CyclicAutoencoder:
        sensors: 3
        interval_num: 15
        conv_kernel_size:
                feature: [[3, 3], [3, 3], [3, 3]]
                time:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
                frequency:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
        conv_stride:
                feature: [[1, 1], [1, 1], [1, 1]]
                time:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
                frequency:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
        conv_inter_channels: 64
        conv_out_channels: 64
        fc_dim: 32
        conv_inter_layer_num: 3
        # Handler loss weight
        classifier_loss_weight: 1
        handler_loss_weight: 3
        # Pretrain config 
        pretrain_epochs: 50
        pretrain_scheduler_step: 20
        pretrain_scheduler_gamma: 0.2
        pretrain_start_lr: 0.0005
        # Finetuning config 
        finetune_epochs: 50
        finetune_scheduler_step: 10
        finetune_scheduler_gamma: 0.2
        finetune_start_lr: 0.00001

# Adversarial AutoEncoder
AdAutoencoder:
        sensors: 3
        # Architecture dims
        ra_block_num: 3
        interval_num: 15
        conv_inter_channels: 128
        conv_out_channels: 64
        conv_kernel_size:
                feature: [[3, 3], [3, 3], [3, 3]]
                time:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
                frequency:
                        EMG: [[1, 4], [3, 5], [3, 5]]
                        EDA: [[1, 4], [3, 5], [3, 5]]
                        Resp: [[1, 4], [3, 5], [3, 5]]
        conv_stride:
                feature: [[1, 1], [1, 1], [1, 1]]
                time:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
                frequency:
                        EMG: [[1, 4], [1, 1], [1, 1]]
                        EDA: [[1, 4], [1, 1], [1, 1]]
                        Resp: [[1, 4], [1, 1], [1, 1]]
        fc_dim: 128
        conv_inter_layer_num: 1
        dropout_ratio: 0.5
        # GAN
        leaky_slope: 0.2
        discriminator_kernel: [3, 1]
        discriminator_conv_channels: 96
        discriminator_conv_channels_out: 16
        linear_in_dim: 512
        # Handler loss weight
        classifier_loss_weight: 1
        handler_loss_weight: 1
        # Pretrain config 
        pretrain_epochs: 50
        pretrain_scheduler_step: 10
        pretrain_scheduler_gamma: 0.2
        pretrain_start_lr: 0.00005
        # Finetuning config 
        finetuning_epoch: 50
        finetuning_scheduler_step: 10
        finetuning_scheduler_gamma: 0.2
        fine_tuning_start_lr: 0.00001

# GateHandler
GateHandler:
        # Handler loss weight
        handler_loss_weight: 0.5
        classifier_loss_weight: 1
        # Finetuning config 
        finetune_epochs: 50
        finetune_scheduler_step: 10
        finetune_scheduler_gamma: 0.2
        finetune_start_lr: 0.00001
